# Бот для поиска Фильмов и сериалов от канала 48/91

Этот Телеграм бот предназначен для поиска информации о фильмах и сериалах через различные источники и предоставления пользователям удобного интерфейса для взаимодействия с результатами поиска. Бот использует API Кинопоиска для получения информации о фильмах и имеет возможность сохранять избранные фильмы для каждого пользователя.

## Оглавление

1. [Обзор](#обзор)
2. [Установка и настройка](#установка-и-настройка)
3. [Основные функции](#основные-функции)
4. [Техническая документация](#техническая-документация)
5. [Использование](#использование)
6. [Расширение и модификация](#расширение-и-модификация)
7. [Контрибьюция](#контрибьюция)
8. [Лицензия](#лицензия)

## Обзор

Этот бот помогает пользователям находить фильмы и сериалы по названию, просматривать информацию о них и добавлять их в избранное. Он интегрируется с двумя основными источниками для поиска — lordserial и goodfilms, а также использует API Кинопоиска для получения дополнительной информации о фильмах.

## Установка и настройка

1. **Клонирование репозитория**

   ```bash
   git clone https://github.com/ваш-репозиторий/название-репозитория.git
   cd название-репозитория
   ```

2. **Создание виртуального окружения и установка зависимостей**

   ```bash
   python -m venv venv
   source venv/bin/activate  # Для Linux/Mac
   venv\Scripts\activate     # Для Windows
   pip install -r requirements.txt
   ```

3. **Создание файла конфигурации**

   Создайте файл `config.json` в корне проекта и добавьте ваш токен бота:

   ```json
   {
     "TOKEN": "ваш_токен"
   }
   ```

4. **Создание базы данных**

   Бот автоматически создаст необходимые таблицы в базе данных при первом запуске.

## Основные функции

1. **Поиск фильмов и сериалов**
   
   Пользователь может ввести название фильма или сериала, и бот выполнит поиск по двум источникам (lordserial и goodfilms). Результаты поиска включают название и ссылку на источник.

2. **Информация о фильме**

   Бот предоставляет информацию о фильме, включая описание и рейтинг с Кинопоиска, если он доступен. Также отображает ссылку на плеер для просмотра фильма.

3. **Избранное**

   Пользователи могут добавлять фильмы в избранное и просматривать их позже. Бот сохраняет избранные фильмы для каждого пользователя в базе данных SQLite.

4. **Навигация по страницам**

   Результаты поиска разбиваются на страницы, и пользователи могут перемещаться между ними с помощью кнопок "Предыдущая" и "Следующая".

5. **Очистка избранного**

   Пользователи могут очистить список избранных фильмов в любой момент.

## Техническая документация

### Основные компоненты

- **Импортируемые модули**
  - `json`: Для работы с конфигурационными файлами.
  - `logging`: Для ведения логов.
  - `sqlite3`: Для работы с SQLite базой данных.
  - `requests`: Для выполнения HTTP-запросов.
  - `BeautifulSoup`: Для парсинга HTML-кода.
  - `hashlib`: Для генерации уникальных идентификаторов.

- **Функции**
  - `get_kinopoisk_data(search_term)`: Получает информацию о фильме из Кинопоиска по названию.
  - `get_page(url, params=None)`: Выполняет HTTP-запрос и возвращает HTML-код страницы.
  - `get_search_results_lordserial(search_term)`: Получает результаты поиска с сайта lordserial.
  - `parse_search_results_lordserial(content)`: Парсит результаты поиска с сайта lordserial.
  - `get_search_results_goodfilms(search_term)`: Получает результаты поиска с сайта goodfilms.
  - `parse_search_results_goodfilms(content)`: Парсит результаты поиска с сайта goodfilms.
  - `build_keyboard(results, current_page, total_pages)`: Создает клавиатуру для навигации по результатам поиска.
  - `build_favorites_keyboard()`: Создает клавиатуру для управления избранным.
  - `build_movie_keyboard(movie_url, player_url, is_favorite=False)`: Создает клавиатуру для страницы фильма.
  - `get_user_favorites(chat_id)`: Получает список избранных фильмов пользователя.
  - `extract_movie_info(movie_page_content, source)`: Извлекает информацию о фильме из HTML-кода страницы.
  - `extract_player_link(movie_page_content)`: Извлекает ссылку на плеер из HTML-кода страницы.

### Обработка команд и сообщений

- **Команда `/start`**: Отправляет приветственное сообщение и предлагает пользователю начать поиск или просмотреть избранное.
- **Обработка нажатий на кнопки**: Управляет навигацией по результатам поиска, добавлением фильмов в избранное и очисткой избранного.
- **Обработка текстовых сообщений**: Выполняет поиск фильмов по введенному названию.

## Использование

1. Запустите бота с помощью следующей команды:

   ```bash
   python bot.py
   ```

2. Откройте чат с ботом в Телеграм и используйте команды и кнопки для поиска фильмов, добавления их в избранное и просмотра информации.

## Расширение и модификация

Этот бот является хорошей отправной точкой для создания более сложных ботов. Вы можете расширить его функциональность, добавив новые источники для поиска, улучшив обработку данных или интегрировав дополнительные API.

### Возможные улучшения

- Добавление поддержки нескольких языков.
- Интеграция с дополнительными источниками данных о фильмах.
- Расширение функционала для обработки сериалов и эпизодов.
